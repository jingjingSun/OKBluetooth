> 手机APP对BLE蓝牙的操作
> 当手机靠近后，2米会发出撤防指令，在非一键启动状态下，远离5米后发出设防指令

### 计算感应距离

目前，通过读取蓝牙的广播信息，只能读取到rssi（信号强度），据说蓝牙外设可以计算出和central（中央）的距离，那么就有两种方式计算感应距离：

* 手机APP 根据rssi 计算

算法很多，可以找到尽量准确的算法来计算

* 蓝牙外设在感知距离变化时主动发送订阅通知

看蓝牙外设的具体情况，如果支持计算距离或者rssi，均可优化

### 设撤防逻辑

#### 手机APP 操控

感应设撤防，应当在不影响用户操作的前提下，进一步保证安全

比如，用户在撤防以后，离开车辆，在达到危险距离时，APP 会发送一个设防指令，此时已然是连接状态；

#### 蓝牙外设操控

这种方案比较简单，而且安全等级更高

首先，可以通过APP 设置，配置蓝牙外设的感应功能，如果设置了感应设撤防，那在蓝牙与手机连接时，自动撤防；断开时，自动设防。

当然也可以通过APP，直接把感应设防的设置同步到蓝牙外设，以后外设在出发设撤防的情况下，自动操作，无需APP 发指令。

在断开以后，手机APP 由于断开的原因，是不知道外设的状态，仅能通过GPS 上报中控状态，最后在同步至APP。